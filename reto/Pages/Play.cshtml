@page
@model PlayModel
@{
    ViewData["Title"] = "Jugar";
}

<style>
    div#gameContainer {
        background: transparent !important;
    }

        div#gameContainer canvas {
        }

            div#gameContainer canvas[data-pixel-art="true"] {
                image-rendering: optimizeSpeed;
                image-rendering: -moz-crisp-edges;
                image-rendering: pixelated;
                -ms-interpolation-mode: nearest-neighbor;
            }
</style>

<div id="gameContainer" class="container">
	<canvas id="unity-canvas" data-pixel-art=""></canvas>
	<script src="~/Build/Builds.loader.js"></script>
	<script>
			createUnityInstance(document.querySelector("#unity-canvas"), {
				dataUrl: "Build/Builds.data",
				frameworkUrl: "Build/Builds.framework.js",
				codeUrl: "Build/Builds.wasm",
				streamingAssetsUrl: "StreamingAssets",
				companyName: "DefaultCompany",
				productName: "Proyecto Final",
				productVersion: "1.0",
			}).then(function (instance) {
				var canvas = instance.Module.canvas;
				var container = canvas.parentElement;
				function onResize() {
					var w;
					var h;

					if (scaleToFit) {
						// MODIFICAR AQUÍ RESPONSIVIDAD
						// Hacer que dependa del tamaño del div responsivo, no de la ventana
						w = window.innerWidth;
						h = window.innerHeight;

						console.log("Ancho detectado: " + w.toString());
                        console.log("Altura detectada: " + h.toString());

						var r = 540 / 960;

						if (w * r > h) {
							w = Math.min(w, Math.ceil(h / r));
						}
						h = Math.floor(w * r);
					} else {
						w = 960;
						h = 540;
					}

					container.style.width = canvas.style.width = w + "px";
					container.style.height = canvas.style.height = h + "px";
					container.style.top = Math.floor((window.innerHeight - h) / 2) + "px";
					container.style.left = Math.floor((window.innerWidth - w) / 2) + "px";
				}

				var scaleToFit;
				try {
					scaleToFit = !!JSON.parse("");
				} catch (e) {
					scaleToFit = true;
				}
				window.addEventListener('resize', onResize);
				onResize();
			});
	</script>
</div>